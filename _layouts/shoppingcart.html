---
layout: default
---

<div class="d-flex align-items-center mt-5 mb-5">

 <div id="volver-fixed"
     class="text-white py-2"
     style="background-color:#1c1c1e; font-size: 0.8rem; position: fixed; top: 56px; left: 0; width: 100%; z-index: 1030; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
  <div class="container d-flex align-items-center">
    <a href="{{site.url}}{{site.baseurl}}/" class="d-flex align-items-center text-decoration-none text-white">
      <i class="fa fa-long-arrow-alt-left me-2"></i>
      <span>Volver</span>
    </a>
  </div>
</div>

  <div id="carrito-listado" class="container mt-4"></div>
</div>



<div id="total-carrito-fixed"
     class="text-white py-2"
     style="background-color:#1c1c1e; font-size: 0.8rem; position: fixed; bottom: 0; left: 0; width: 100%; z-index: 1030; box-shadow: 0 -2px 10px rgba(0,0,0,0.2);">
  <div class="container text-center">
    <h6>Total: $<span id="total-sum"></span></h6>
    <div class="cart mt-2 d-flex justify-content-center gap-2">
      <button class="btn btn-sm btn-danger" onclick="clearLocalStorage()">LIMPIAR CARRITO</button>
      <button class="btn btn-sm btn-success" onclick="clearLocalStorage()">REALIZAR PEDIDO</button>
    </div>
  </div>
</div>



<script>
  renderizarCarrito();

  function renderizarCarrito() {
    const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    const contenedor = document.getElementById('carrito-listado');
    contenedor.innerHTML = '';

    if (carrito.length === 0) {
      contenedor.innerHTML = '<p class="text-center text-muted">Tu carrito está vacío.</p>';
      document.getElementById('total-sum').textContent = '0';
      return;
    }

    carrito.forEach((producto) => {
      if (!producto.uid) {
        producto.uid = crypto.randomUUID();
      }

      const item = document.createElement('div');
      item.classList.add('mb-3');
      item.id = `producto-${producto.uid}`;


item.innerHTML = `
 <div class="d-flex align-items-center justify-content-between flex-wrap">
  <div class="d-flex flex-wrap align-items-start border-bottom py-3 position-relative w-100">
    <img src="${producto.image}" alt="${producto.name}" 
         class="me-3 rounded" 
         style="width: 20vw; max-width: 100px; height: auto; object-fit: cover;">
    
    <div class="flex-grow-1">
      <h6 class="text-white text-truncate mb-1" style="max-width: 100%;">${producto.name} T-SHIRT</h6>
      <small class="text-white d-block mb-2">
        <strong>Tela:</strong> ${producto.tela} 
        <strong>Género:</strong> ${producto.genero}<br> 
        <strong>Talla:</strong> ${producto.talla} 
        <strong>Color:</strong> ${producto.color}
      </small>

    <div class="d-flex flex-wrap align-items-center justify-content-between">
  <div class="d-flex align-items-center mb-2">
    <button class="btn btn-outline-secondary btn-sm" onclick="cambiarCantidad('${producto.uid}', -1)">−</button>
    <div class="quantity x-2 fs-5 mx-2">${producto.cantidad}</div>
    <button class="btn btn-outline-secondary btn-sm" onclick="cambiarCantidad('${producto.uid}', 1)">+</button>
  </div>

  <div class="ms-sm-3 mt-2 mt-sm-0">
    <strong class="price-total fs-5">$${(producto.price * producto.cantidad).toLocaleString('es-ES')}</strong>
  </div>
</div>

      <button class="btn btn-link text-danger position-absolute top-0 end-0" onclick="eliminarProducto('${producto.uid}')">
        <i class="fa fa-trash"></i>
      </button>
    </div>
  </div>
</div>
`;



      contenedor.appendChild(item);
    });


    calcularTotal(carrito);
    localStorage.setItem('carrito', JSON.stringify(carrito));
  }

  function calcularTotal(carrito) {
    const total = carrito.reduce((sum, producto) => sum + (producto.price * producto.cantidad), 0);
    document.getElementById('total-sum').textContent = total.toLocaleString('es-ES');
  }

  function cambiarCantidad(uid, cambio) {
    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    const producto = carrito.find(p => p.uid === uid);

    if (producto) {
      producto.cantidad += cambio;
      if (producto.cantidad < 1) producto.cantidad = 1;
      if (producto.cantidad > 99) producto.cantidad = 99;

      localStorage.setItem('carrito', JSON.stringify(carrito));

      const contenedor = document.getElementById(`producto-${uid}`);
      if (contenedor) {
        contenedor.querySelector('.quantity').textContent = producto.cantidad;
        contenedor.querySelector('.price-total').textContent =
          `$${(producto.price * producto.cantidad).toLocaleString('es-ES')}`;
      }
      actualizarContadorCarrito();
      calcularTotal(carrito);
    }
  }

  function eliminarProducto(uid) {
    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    carrito = carrito.filter(p => p.uid !== uid);
    localStorage.setItem('carrito', JSON.stringify(carrito));

    const productoElemento = document.getElementById(`producto-${uid}`);
    if (productoElemento) {
      productoElemento.remove();
    }

    if (carrito.length === 0) {
      document.getElementById('carrito-listado').innerHTML = '<p class="text-center text-muted">Tu carrito está vacío.</p>';
      document.getElementById('total-sum').textContent = '0';
    }

    if (typeof actualizarContadorCarrito === 'function') {
      actualizarContadorCarrito();
    }

    calcularTotal(carrito);
  }

  function clearLocalStorage() {
    localStorage.clear();
    location.reload();
  }
</script>